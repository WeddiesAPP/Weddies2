<!DOCTYPE html>
<html>
<head>
<style>
.nav {
    position: fixed;
    bottom: 0;
    width: 100%;
    height: 10vh;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.2);
    background-color: #ffffff;
  display: none;
    overflow-x: auto;
    z-index: 9999;
}

.nav__link {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
    min-width: 50px;
    overflow: hidden;
    white-space: nowrap;
    font-family: sans-serif;
    font-size: 13px;
    color: #444444;
    text-decoration: none;
    -webkit-tap-highlight-color: transparent;
    transition: background-color 0.1s ease-in-out;
    z-index: 9999;
}

.nav__link:hover {
    background-color: #eeeeee;
    z-index: 9999;
}

.nav__link--active {
    color: #009578;
    z-index: 9999;
}

.nav__icon {
    font-size: 18px;
    z-index: 9999;
}
.material-symbols-outlined {
  font-variation-settings:
  'FILL' 1,
  'wght' 700,
  'GRAD' 0,
  'opsz' 72;
  color: black;

}
.nav__link--active .material-symbols-outlined {
  color: #009578; /* This sets the color for the active link */
}

  .match {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border: 1px solid #ccc;
  border-radius: 10px;
  margin: 10px;
  background-color: #f9f9f9;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.homeLogo,
.awayLogo {
  width: 40px;
  height: 40px;
}

.matchTime {
  font-size: 16px;
}

.homeName,
.awayName {
  font-size: 14px;
}
.league {
  margin-bottom: 20px;
  padding: 10px;
  background-color: #f4f4f4;
}

.league h2 {
  margin: 0;
  padding: 10px;
  background-color: #ddd;
}

</style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <title>Matches Page</title>
</head>
<body>

<nav class="nav">
    <a href="index.html" class="nav__link">
        <span class="material-symbols-outlined">
            pin_drop
        </span>
    </a>
    <a href="#" class="nav__link">
        <span class="material-symbols-outlined">
            person
        </span>
    </a>
    <a href="matches.html" class="nav__link nav__link--active">
        <span class="material-symbols-outlined">
            table_rows
        </span>
    </a>
</nav>

<h1>This is the matches page.</h1>
<label for="dateInput">Select a date:</label>
  <input type="date" id="datePicker">

 <div id="matchContainer">
    <!-- Match divs will be populated by JavaScript -->
  </div>
</body>
<script>
let clubs = [];
let allFixtures = [];
// Fetch the CSV file
fetch('teamsdata.csv')
.then((response) => response.text())
.then((csvString) => {
  // Parse the CSV string
  Papa.parse(csvString, {
    header: true, // Specify that the CSV file has headers
    dynamicTyping: false,
    skipEmptyLines: true,
    complete: function (results) {
      clubs = results.data.map((row) => {
        return {
          leagueID: row.leagueID,
          countryID: row.countryID,
          leagueName: row.leagueName,
          leagueActive: row.leagueActive,
          leagueShortCode: row.leagueShortCode,
          leagueImage: row.leagueImageName,
          leagueType: row.leagueType,
          leagueSubType: row.leagueSubType,
          leagueLastPlayedAt: row.leagueLastPlayedAt,
          leagueCategory: row.leagueCategory,
          seasonID: row.seasonID,
          seasonName: row.seasonName,
        clubID: row.teamID,
          clubName: row.teamName,
          clubImageName: row.clubImageName,
          clubFounded: row.clubFounded,
          clubGender: row.clubGender,
          stadiumID: row.stadiumID,
          stadiumName: row.stadiumName,
          stadiumCity: row.stadiumCity,
          stadiumAdress: row.stadiumAdress,
          stadiumZipcode: row.stadiumZipcode,
          latitude: parseFloat(row.latitude.replace(',', '.')),
         longitude: parseFloat(row.longitude.replace(',', '.')),
          stadiumSurface: row.stadiumSurface,
          stadiumCapacity: row.stadiumCapacity,
        };
      });
      // Call your existing functions with the new data
    loadFixtures();
      console.log(clubs);
    },
  });
})
.catch((error) => {
  console.error('An error occurred while fetching the CSV file:', error);
});

function loadFixtures() {
  const today = new Date().toISOString().split('T')[0]; // get today's date in YYYY-MM-DD format
  document.getElementById('datePicker').value = today; // set the date picker to today

  fetch('fixtures.csv')
    .then(response => response.text())
    .then(csvString => {
      Papa.parse(csvString, {
        header: true,
        skipEmptyLines: true,
        complete: function (results) {
          allFixtures = results.data.map(row => {
            const [homeTeamName, awayTeamName] = row.Name.split(' vs ');
            const homeTeam = clubs.find(club => club.clubName === homeTeamName);
            const awayTeam = clubs.find(club => club.clubName === awayTeamName);
            return {
              date: row.Date,
              leagueID: row['League ID'], // Include the League ID
              homeTeam: homeTeam || { clubName: homeTeamName, clubImageName: 'default.jpg' },
              awayTeam: awayTeam || { clubName: awayTeamName, clubImageName: 'default.jpg' },
              time: row['Starting At'],
            };
          });

          updateMatchesForDate(today);
        },
      });
    })
    .catch(error => console.error('An error occurred while fetching fixtures.csv:', error));
}
document.getElementById('datePicker').addEventListener('change', function() {
  const selectedDate = this.value; // Get the selected date in YYYY-MM-DD format
  updateMatchesForDate(selectedDate);
});

function updateMatchesForDate(selectedDate) {
  // Filter the matches for the selected date
  const filteredMatches = allFixtures.filter(match => match.date === selectedDate);

  // Clear the current matches
  document.getElementById('matchContainer').innerHTML = '';

  // Display the new matches
  displayMatches(filteredMatches);
}
// Function to display matches
function displayMatches(matches) {
  const matchContainer = document.getElementById('matchContainer');
  matchContainer.innerHTML = ''; // Clear previous matches

  // Group the matches by league
  const matchesByLeague = {};
  matches.forEach(match => {
    const leagueID = match.leagueID;
    if (!matchesByLeague[leagueID]) {
      matchesByLeague[leagueID] = [];
    }
    matchesByLeague[leagueID].push(match);
  });

  // Create a div for each league and add its matches
  for (const [leagueID, leagueMatches] of Object.entries(matchesByLeague)) {
    const leagueDiv = document.createElement('div');
    leagueDiv.className = 'league';

    const leagueName = document.createElement('h2');
    const leagueInfo = clubs.find(club => club.leagueID === leagueID);
    leagueName.textContent = leagueInfo ? leagueInfo.leagueName : 'Unknown League';
    leagueDiv.appendChild(leagueName);

    leagueMatches.forEach(match => {
      const matchDiv = document.createElement('div');
      matchDiv.className = 'match';

      const homeLogo = document.createElement('img');
      homeLogo.src = match.homeTeam.clubImageName;
      homeLogo.className = 'homeLogo';

      const awayLogo = document.createElement('img');
      awayLogo.src = match.awayTeam.clubImageName;
      awayLogo.className = 'awayLogo';

      const timeDiv = document.createElement('div');
      timeDiv.className = 'matchTime';
      timeDiv.textContent = match.time;

      const homeName = document.createElement('div');
      homeName.className = 'homeName';
      homeName.textContent = match.homeTeam.clubName;

      const awayName = document.createElement('div');
      awayName.className = 'awayName';
      awayName.textContent = match.awayTeam.clubName;

      matchDiv.appendChild(homeLogo);
      matchDiv.appendChild(homeName);
      matchDiv.appendChild(timeDiv);
      matchDiv.appendChild(awayName);
      matchDiv.appendChild(awayLogo);
      leagueDiv.appendChild(matchDiv);
    });

    matchContainer.appendChild(leagueDiv);
  }
}


 var navBar = document.querySelector(".nav");
  navBar.style.display = "flex";
  const navigation_items_elms = document.querySelectorAll(
  ".navigation-bar .list-items .item"
);
const navigation_pointer = document.querySelector(".navigation-bar .pointer");

navigation_items_elms.forEach((item, index) => {
  item.addEventListener("click", (e) => {
    e.preventDefault();
    navigation_items_elms.forEach((itm) => itm.classList.remove("active"));
    item.classList.add("active");

    const parentWidth = item.parentElement.clientWidth;
    const lefPercent = (parentWidth / navigation_items_elms.length) * index;
    navigation_pointer.style.left = lefPercent + "px";
  });
});
</script>

</html>
